# arduino program for gamecube
Arduino microを使ってGamecubeを操作するためのソースコードです。

## 外部依存ライブラリ
外部依存ライブラリは、[NicoHood/Nintendo](https://pages.github.com/](https://github.com/NicoHood/Nintendo ) になります。

## ゲームキューブとの配線

Arduino microとゲームキューブの配線は、下記2本です。
 * デジタル5番ピン－ゲームキューブコントローラーの「データ線」
 * GND－ゲームキューブコントローラーの「GND線」

ただし、上記配線の中に、双方向レベル変換モジュールを噛ませる必要があるようです。
Arduino micro（5V）-ゲームキューブ（3.3V）で変換する必要があるので、それに注意して配線しましょう。

## つくったきっかけ
ゲームキューブをArduinoで操作するためのプログラムが公開されており、感銘を受けて、私も早速試してみました。
ただ、ソースコード単品（人様が公開しているGUIに依存しない形）で、Arduinoでゲームキューブの操作を自動化してみたいと思ったので作ってみました。


## このプログラムでできること
シリアルモニタに`a`や`b`、`x`、`r`などを入力して、操作ゲームキューブを操作できます **（大文字と小文字は区別されます！）** 。
また、上下左右には`U`, `D`, `R`, `L`を入力してください。
**予めプログラムに入力した「自動化コマンド（30行目）」を実行するには、シリアルモニタで`p`を送信**してください。

![COM5 2022-07-09 20-52-00-0001](https://user-images.githubusercontent.com/107760099/178104546-7caae22c-8ba5-45ea-b1e0-5bc9f34169bb.gif)



## つかいかた（How to edit source code to automate GC input）
**ソースコードの30行目**にある配列`autocommand[]`に、ご自身でコマンドを入力することで、自動化することができます。

入力する際には、必ず配列`autocommand[]`の最初と最後には` {"-", 0},`を挿入するようにしてください。

コマンドは、`{  "コマンド"  , MS(  長押しさせたいミリ秒  )}, `で指定できます。

この`"コマンド"`に指定できるのは、`"A"`, `"B"`, `"X"`, `"Y"`, `"R"`, `"L"`, `"START"`, `"RIGHT"`, `"LEFT"`, `"UP"`, `"DOWN"`または`"0"`～`"360"`です。

また、`MS(長押しさせたいミリ秒)`には整数で、例えば`MS(800)`のように指定します。

デフォルトでは、**単位が「ミリ秒」ではありません**ので、**ミリ秒変換用のマクロ`MS(x)`を使って**時間を指定してください。


また、待機させたい場合は、コマンドに`"WAIT"`を指定します。

例として、下記に「0.2秒間スティックを倒して、0.5秒待機するプログラム」の書き方を示します。
配列「`autocommand[]`」に入れます。

**必ず、最初と最後は`  {"-", 0}, `で挟み込むようにしてください！**

```
struct{
  char command[11];
  long int holdtime;
} autocommand[]={
  {"-", 0}, // start with this command
  {"0",    MS(200)},{"WAIT", MS(500)},
  {"30",   MS(200)},{"WAIT", MS(500)},
  {"45",   MS(200)},{"WAIT", MS(500)},
  {"60",   MS(200)},{"WAIT", MS(500)},
  {"90",   MS(200)},{"WAIT", MS(500)},
  {"120",  MS(200)},{"WAIT", MS(500)},
  {"135",  MS(200)},{"WAIT", MS(500)},
  {"150",  MS(200)},{"WAIT", MS(500)},
  {"180",  MS(200)},{"WAIT", MS(500)},
  {"210",  MS(200)},{"WAIT", MS(500)},
  {"225",  MS(200)},{"WAIT", MS(500)},
  {"240",  MS(200)},{"WAIT", MS(500)},
  {"270",  MS(200)},{"WAIT", MS(500)},
  {"300",  MS(200)},{"WAIT", MS(500)},
  {"330",  MS(200)},{"WAIT", MS(500)},
  {"345",  MS(200)},{"WAIT", MS(500)},
  {"360",  MS(200)},{"WAIT", MS(500)},
  {"-", 0}, // end with this command
};
```

## 参考情報
すごく参考にさせていただいたのは[mizuyoukanao/WHALE](https://github.com/mizuyoukanao/WHALE ) です。
